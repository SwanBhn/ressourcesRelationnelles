{% extends 'base.html.twig' %}

{% block title %}Ressources{% endblock %}

{% block body %}
<div class="tableRessources">

{% for type, messages in app.flashes %}
    {% for message in messages %}
        <div class="alert alert-{{ type }}">{{ message }}</div>
    {% endfor %}
{% endfor %}

    <h1>Ressources</h1>

    <table class="table table-striped table-bordered table-hover">
        <thead>
            <tr>
                <th scope="col">Titre</th>
                <th scope="col">Contenu</th>
                <th scope="col">DateCreation</th>
                <th scope="col">Multimedia</th>
                <th scope="col">Categorie</th>
                <th scope="col">Participants</th>
                {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                    <th scope="col">Actions</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for ressource in ressources %}
            <tr>
                <td >{{ ressource.titre }}</td>
                <td>{{ ressource.contenu }}</td>
                <td>{{ ressource.dateCreation|date('Y-m-d') }}</td>
                <td><img src="{{ ressource.multimedia }}" style="width:200px"/></td>
                <td>{{ ressource.idCategorie.nom }}</td>
                <td>{{ ressource.idUtilisateur.nom }}</td>
                {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                    <td>
                        {% if utilisateurId == ressource.idUtilisateur.id %}
                            <form method="delete" action="{{ path('app_supprimer_ressource', {'id': ressource.id}) }}" onsubmit="return confirm('Êtes-vous sûr de vouloir supprimer cette ressource ?')">
                                <button type="submit" class="btn btn-danger">Supprimer</button>
                            </form>
                        {% endif %}
                        <a href="{{path('app_detailressources', {'id' : ressource.id}) }}">
                            <button class="btn btn-primary">Consulter</button>
                        </a>
                    </td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}